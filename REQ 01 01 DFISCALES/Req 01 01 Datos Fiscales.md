# REQ 01 01 : Datos Fiscales

## Requisitos
1) lista de empresas
   > datos a incluir: Cuit, Razon Social, Domicilio Fiscal
2) alta de Empresa 
   > Verificar cuit valido, y no repetido => status = 1 
3) bloquear datos
   > una vez verificados => status = 2
4) edicion de datos 
   > solo si no estan verificados, requiere desbloqueo
5) Inhabilitacion de Empresa
   > por que se da de baja el cuit, => status = -1
6) recuperar informacion



## RQ No Funcional      
1) Acceso solo Administrador   
1) ContraseÃ±a Encriptada  
1) Administrador no puede auto eliminarse 


## Capa Datos
### T_DFISCAL [>>](t_dfiscal.sql)



## Vistas
### DFISCAL [>>](users.view.sql)


## Applicaction Items

## Funciones
### DFISCALES_PKG [>>](<003 Apex Workspace/access_control_pkg.sql>)
* ADD_CUIT
* VALID_CUIT
* disable
* enable
* 


## Diagrama de Paginas
![Diagrama de Paginas](<dfd 00 01 Access Control.png>)



## NOTAS

## ToDo

## referencias


## Archivo Padron.txt
> Archivo descargado de la pag AFIP. 
> Directorio /home/oracle/DP

```sql
create directory DP as '/home/oracle/DP';

```
> Copiar Archivo desde otro servidor
```
 scp -P 1599 oracle@179.41.5.74:/media/oracle/padron.txt .
```

## Crear tabla externa
```sql
CREATE TABLE te_dfiscales(
    cuit            CHAR(11 BYTE)
    ,title           CHAR(30 BYTE)
    ,imp_ganancias   CHAR(2 BYTE)
    ,imp_iva         CHAR(2 BYTE)
    ,monotributo     CHAR(2 BYTE)
    ,integrante_soc  CHAR(1 BYTE)
    ,empleador       CHAR(1 BYTE)
    ,act_monotributo CHAR(2 BYTE)
)
ORGANIZATION EXTERNAL(TYPE oracle_loader
    DEFAULT DIRECTORY dp ACCESS PARAMETERS(
        RECORDS DELIMITED BY NEWLINE
        FIELDS(
            cuit CHAR(11)
        ,title CHAR(30)
        ,imp_ganancias CHAR(2)
        ,imp_iva CHAR(2)
        ,monotributo CHAR(2)
        ,integrante_soc CHAR(1)
        ,empleador CHAR(1)
        ,act_monotributo CHAR(2)
        )
    )LOCATION(dp : 'padron.txt')
)REJECT LIMIT UNLIMITED;
```
## tabla t_dfiscales
```sql
create table t_dfiscales (
    id                             number generated by default on null as identity 
                                   constraint t_dfiscales_pk primary key,
    title                          varchar2(400 char),
    cuit                           varchar2(11 char),
    domicilio                      varchar2(400 char),
    ciudad                         varchar2(80 char),
    cp                             varchar2(10 char),
    provincia_id                   number,
    partido_id                     number,
    tipo_persona                   number,
    IMP_GANANCIAS       varchar2(2 char),
    IMP_IVA             varchar2(2 char),
    MONOTRIBUTO         varchar2(2 char),
    INTEGRANTE_SOC      varchar2(1 char),
    EMPLEADOR           varchar2(1 char),
    ACT_MONOTRIBUTO     varchar2(2 char),
    created                        date not null,
    created_by                     varchar2(255 char) not null,
    updated                        date not null,
    updated_by                     varchar2(255 char) not null
);
```
