var myescala=.5,escala_ref_largo=600,escala_ref_ancho=280,borde=10;function dibujar_plano(e="myplano"){var t=document.getElementById(e),l=t.getContext("2d");l.setTransform(1,0,0,1,0,0),l.clearRect(0,0,t.width,t.height),l.fillStyle="#ffffff",l.fillRect(0,0,t.width,t.height);var a="P"+$v("pFlowStepId")+"_",o=$x(a+"ART_TIPO_ID").value,r=document.getElementById("P30_PLARGO").value,i=document.getElementById("P30_PANCHO").value;escala=Math.min(escala_ref_largo/r,escala_ref_ancho/i),l.translate(20,20),l.fillText(escala,200,200),l.setTransform(escala,0,0,escala,t.clientWidth/2,50);var s=1/escala;t.clientWidth,t.clientHeight;l.strokeStyle="#000000",l.lineWidth=2*s;var m=25*s;l.font=(0|m)+"px Arial";var d=r/2;if(l.save(),l.translate(-d,0),l.beginPath(),l.rect(0,0,r,i),l.stroke(),l.restore(),l.fillStyle="#000",l.textAlign="center",l.fillText(r,0,i+10),"0"==o||"1"==o){var f=Number(document.getElementById("P30_MULT_X").value);if(f>1){l.save(),l.translate(-d,0);for(var v=Number(document.getElementById("P30_LARGO").value),g=1;g<f;g++)l.beginPath(),l.moveTo(v*g,0),l.lineTo(v*g,i),l.stroke();l.restore()}}if("0"==o){var u=Number(document.getElementById("P30_MULT_Y").value);if(u>1){l.save(),l.translate(-d,0);var c=Number(document.getElementById("P30_ANCHO").value);for(g=1;g<u;g++)l.beginPath(),l.moveTo(0,c*g),l.lineTo(r,c*g),l.stroke();l.restore()}}if("1"==o||"5"==o||"7"==o||"8"==o||"9"==o){var T=document.getElementById("P30_TRAZADOS").value.split(":"),h=0;for(l.save(),l.translate(-d,0),g=0;g<T.length-1;g++)h+=1*T[g],l.beginPath(),l.moveTo(0,h),l.lineTo(r,h),l.stroke();h=0;var _=0,P=0;for(l.translate(r,0),l.textAlign="left",g=0;g<T.length;g++)P=(h+=1*T[g])/2+_/2,l.fillText(Math.round(T[g]),10,P),_=h;l.restore()}if("1"==o||"4"==o||"5"==o||"7"==o||"8"==o||"9"==o){T=document.getElementById("P30_SLOTTER").value.split(":"),h=0;for(l.save(),l.translate(-d,0),g=0;g<T.length;g++)h+=1*T[g],l.beginPath(),l.moveTo(h,0),l.lineTo(h,i),l.stroke();h=0;_=0;var y=0;for(l.textAlign="center",g=0;g<T.length;g++)y=(h+=1*T[g])/2+_/2,l.fillText(T[g],y,-10),_=h;l.restore()}if("6"==o){var I=document.getElementById("P30_SLOTTER").value,E=document.getElementById("P30_MULT_X").value,A=document.getElementById("P30_MULT_Y").value,x=document.getElementById("P30_ANCHO").value,B=document.getElementById("P30_LARGO").value,b=document.getElementById("P30_PANCHO").value,k=document.getElementById("P30_PLARGO").value,O=I.split(":");h=0;for(l.save(),l.translate(-d,0),n=0;n<E;n++)for(g=0;g<O.length;g++)h+=1*O[g],g<O.length-1&&(l.strokeStyle="#101080",l.lineWidth=10,l.beginPath(),l.moveTo(h,0),l.lineTo(h,x/2),l.stroke(),"2"==A&&(l.beginPath(),l.moveTo(h,3*x/2),l.lineTo(h,2*x),l.stroke()));if(l.strokeStyle="#101080",l.lineWidth=3*s,E>"1")for(g=0;g<f;g++)l.beginPath(),l.moveTo(B*g,0),l.lineTo(B*g,b),l.stroke();l.strokeStyle="#008000",l.lineWidth=3*s,"2"==A&&(l.beginPath(),l.moveTo(0,x),l.lineTo(k,x),l.stroke()),h=0;_=0,y=0;for(l.textAlign="center",n=0;n<E;n++)for(g=0;g<O.length;g++)y=(h+=1*O[g])/2+_/2,l.fillText(O[g],y,-10),_=h;h=0;_=0,P=0;l.translate(r,0),l.textAlign="left",l.fillText(Math.round(x/2),10,25*s),l.fillText(Math.round(x/2),10,b),"2"==A&&l.fillText(Math.round(x),10,b/2+10),l.restore()}}